import { IInstantiationService } from '../../../../../util/vs/platform/instantiation/common/instantiation';
import { TextDocumentItem, VersionedTextDocumentIdentifier, WorkspaceFolder } from '../../types/src';
import { ICompletionsFileSystemService } from './fileSystem';
import { INotebookDocument, IRange, ITextDocument, TextDocumentIdentifier, TextDocumentResult, TextDocumentValidation } from './textDocument';
import { Event } from './util/event';
/**
 * An interface describing an individual change in the text of a document.
 */
interface TextDocumentContentChangeEvent {
    /**
     * The range that got replaced.
     */
    readonly range: IRange;
    /**
     * The offset of the range that got replaced.
     */
    readonly rangeOffset: number;
    /**
     * The length of the range that got replaced.
     */
    readonly rangeLength: number;
    /**
     * The new text for the range.
     */
    readonly text: string;
}
/**
 * An event describing a document open.
 * @public KEEPING FOR TESTS
 */
export interface TextDocumentOpenEvent {
    /**
     * The affected document.
     */
    readonly document: TextDocumentItem;
}
/**
 * An event describing a transactional document change.
 * @public KEEPING FOR TESTS
 */
export interface TextDocumentChangeEvent {
    /**
     * The affected document.
     */
    readonly document: VersionedTextDocumentIdentifier;
    /**
     * An array of content changes.
     */
    readonly contentChanges: readonly TextDocumentContentChangeEvent[];
}
/**
 * An event describing a document close.
 * @public KEEPING FOR TESTS
 */
export interface TextDocumentCloseEvent {
    readonly document: TextDocumentIdentifier;
}
/** @public KEEPING FOR TESTS */
export interface TextDocumentFocusedEvent {
    readonly document?: TextDocumentIdentifier;
}
export interface WorkspaceFoldersChangeEvent {
    readonly workspaceFolders: WorkspaceFolder[];
    readonly added: WorkspaceFolder[];
    readonly removed: WorkspaceFolder[];
}
export declare const ICompletionsTextDocumentManagerService: import("../../../../../util/common/services").ServiceIdentifier<ICompletionsTextDocumentManagerService>;
export interface ICompletionsTextDocumentManagerService {
    readonly _serviceBrand: undefined;
    onDidChangeTextDocument: Event<TextDocumentChangeEvent>;
    onDidOpenTextDocument: Event<TextDocumentOpenEvent>;
    onDidCloseTextDocument: Event<TextDocumentCloseEvent>;
    onDidFocusTextDocument: Event<TextDocumentFocusedEvent>;
    onDidChangeWorkspaceFolders: Event<WorkspaceFoldersChangeEvent>;
    textDocuments(): Promise<ITextDocument[]>;
    /**
     * Get all open text documents, skipping content exclusions and other validations.
     */
    getTextDocumentsUnsafe(): ITextDocument[];
    /**
     * Get the text document for the given URI, skipping content exclusions and other validations.
     */
    getTextDocumentUnsafe(docId: TextDocumentIdentifier): ITextDocument | undefined;
    /**
     * Get the text document for the given URI, checking content exclusions and other validations.
     */
    getTextDocument(docId: TextDocumentIdentifier): Promise<ITextDocument | undefined>;
    /**
     * Get a TextDocumentValidation for the given document URI.  Unlike other methods, this supports reading the
     * document from disk.
     */
    getTextDocumentValidation(docId: TextDocumentIdentifier): Promise<TextDocumentValidation>;
    /**
     * Get a TextDocumentResult for the given document URI.
     */
    getTextDocumentWithValidation(docId: TextDocumentIdentifier): Promise<TextDocumentResult<ITextDocument>>;
    /**
     * If `TextDocument` represents notebook returns `INotebookDocument` instance, otherwise returns `undefined`
     */
    findNotebook(doc: TextDocumentIdentifier): INotebookDocument | undefined;
    getWorkspaceFolders(): WorkspaceFolder[];
    getWorkspaceFolder(doc: TextDocumentIdentifier): WorkspaceFolder | undefined;
    /**
     * Get the path of the given document relative to one of the workspace folders,
     * or its basename if it is not under any of the workspace folders.
     * Returns `undefined` if the file is untitled.
     */
    getRelativePath(doc: TextDocumentIdentifier): string | undefined;
}
export declare abstract class TextDocumentManager implements ICompletionsTextDocumentManagerService {
    private readonly instantiationService;
    private readonly fileSystem;
    _serviceBrand: undefined;
    abstract onDidChangeTextDocument: Event<TextDocumentChangeEvent>;
    abstract onDidOpenTextDocument: Event<TextDocumentOpenEvent>;
    abstract onDidCloseTextDocument: Event<TextDocumentCloseEvent>;
    abstract onDidFocusTextDocument: Event<TextDocumentFocusedEvent>;
    abstract onDidChangeWorkspaceFolders: Event<WorkspaceFoldersChangeEvent>;
    /**
     * Get all open text documents, skipping content exclusions and other validations.
     */
    abstract getTextDocumentsUnsafe(): ITextDocument[];
    constructor(instantiationService: IInstantiationService, fileSystem: ICompletionsFileSystemService);
    textDocuments(): Promise<ITextDocument[]>;
    /**
     * Get the text document for the given URI, skipping content exclusions and other validations.
     */
    getTextDocumentUnsafe(docId: TextDocumentIdentifier): ITextDocument | undefined;
    /**
     * Get the text document for the given URI, checking content exclusions and other validations.
     */
    getTextDocument(docId: TextDocumentIdentifier): Promise<ITextDocument | undefined>;
    private validateTextDocument;
    /**
     * Get a TextDocumentValidation for the given document URI.  Unlike other methods, this supports reading the
     * document from disk.
     */
    getTextDocumentValidation(docId: TextDocumentIdentifier): Promise<TextDocumentValidation>;
    /**
     * Get a TextDocumentResult for the given document URI.
     */
    getTextDocumentWithValidation(docId: TextDocumentIdentifier): Promise<TextDocumentResult<ITextDocument>>;
    private notFoundResult;
    /**
     * Implements ability to open a text document that is currently not open (and not tracked by the document manager).
     *
     * This is usually used with asychronous operations like the postInsertion callbacks that
     * analyze a document long time after the user interacted with it.
     */
    protected readTextDocumentFromDisk(uri: string): Promise<string | undefined>;
    /**
     * If `TextDocument` represents notebook returns `INotebookDocument` instance, otherwise returns `undefined`
     */
    abstract findNotebook(doc: TextDocumentIdentifier): INotebookDocument | undefined;
    abstract getWorkspaceFolders(): WorkspaceFolder[];
    getWorkspaceFolder(doc: TextDocumentIdentifier): WorkspaceFolder | undefined;
    /**
     * Get the path of the given document relative to one of the workspace folders,
     * or its basename if it is not under any of the workspace folders.
     * Returns `undefined` if the file is untitled.
     */
    getRelativePath(doc: TextDocumentIdentifier): string | undefined;
}
export {};
//# sourceMappingURL=textDocumentManager.d.ts.map