import { ComponentStatistics } from '../../../prompt/src/components/components';
import { ContextUsageStatistics, ResolutionStatus } from '../../../types/src';
import { SupportedContextItemWithId } from './contextProviders/contextItemSchemas';
export type PromptExpectation = 'included' | 'content_excluded';
export type PromptMatcher = {
    source: SupportedContextItemWithId;
    expectedTokens: number;
    actualTokens: number;
};
export declare const ICompletionsContextProviderService: import("../../../../../../util/common/services").ServiceIdentifier<ICompletionsContextProviderService>;
export interface ICompletionsContextProviderService {
    readonly _serviceBrand: undefined;
    getStatisticsForCompletion(completionId: string): PerCompletionContextProviderStatistics;
    getPreviousStatisticsForCompletion(completionId: string): PerCompletionContextProviderStatistics | undefined;
}
export declare class ContextProviderStatistics implements ICompletionsContextProviderService {
    private readonly createStatistics;
    _serviceBrand: undefined;
    private statistics;
    constructor(createStatistics?: () => PerCompletionContextProviderStatistics);
    getStatisticsForCompletion(completionId: string): PerCompletionContextProviderStatistics;
    getPreviousStatisticsForCompletion(completionId: string): PerCompletionContextProviderStatistics | undefined;
}
export declare class PerCompletionContextProviderStatistics {
    opportunityId: string | undefined;
    protected _expectations: Map<string, [SupportedContextItemWithId, PromptExpectation][]>;
    protected _lastResolution: Map<string, ResolutionStatus>;
    protected _statistics: Map<string, ContextUsageStatistics>;
    constructor();
    addExpectations(providerId: string, expectations: [SupportedContextItemWithId, PromptExpectation][]): void;
    clearExpectations(): void;
    setLastResolution(providerId: string, resolution: ResolutionStatus): void;
    setOpportunityId(opportunityId: string): void;
    get(providerId: string): ContextUsageStatistics | undefined;
    getAllUsageStatistics(): IterableIterator<[string, ContextUsageStatistics]>;
    computeMatch(promptMatchers: PromptMatcher[]): void;
}
export declare function componentStatisticsToPromptMatcher(promptComponentStatistics: ComponentStatistics[]): PromptMatcher[];
//# sourceMappingURL=contextProviderStatistics.d.ts.map