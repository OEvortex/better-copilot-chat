import { CancellationToken } from 'vscode-languageserver-protocol';
import { type ComponentContext, type PromptComponentChild, type PromptElement, type PromptElementProps } from './components';
import { DataConsumer, Dispatch, StateUpdater, TypePredicate, UseData } from './hooks';
import { DataPipe } from './virtualPrompt';
/**
 * A virtual prompt node is an in-memory representation of a prompt component in its rendered form.
 * It is constructed from a `PromptElement` and contains the name of the component that it was constructed from, and resolved external context and state.
 */
export type VirtualPromptNode = {
    name: string;
    path: string;
    props?: PromptElementProps;
    children?: VirtualPromptNode[];
    component?: PromptComponentChild;
    lifecycle?: PromptElementLifecycle;
};
/**
 * Translate a `PromptComponentChild` object into a virtual prompt node.
 */
export declare class VirtualPromptReconciler {
    private lifecycleData;
    private vTree;
    constructor(prompt: PromptElement);
    reconcile(cancellationToken?: CancellationToken): VirtualPromptNode | undefined;
    private reconcileNode;
    private virtualizeElement;
    private virtualizeFunctionComponent;
    private ensureUniqueKeys;
    private collectChildPaths;
    private cleanupState;
    private getOrCreateLifecycleData;
    createPipe(): DataPipe;
    private pumpData;
    private recursivelyPumpData;
}
declare class PromptElementLifecycleData {
    state: unknown[];
    _updateTimeMs: number;
    constructor(state: unknown[]);
    getUpdateTimeMsAndReset(): number;
}
declare class PromptElementLifecycle implements ComponentContext {
    readonly lifecycleData: PromptElementLifecycleData;
    private readonly stateHook;
    readonly dataHook: UseData;
    constructor(lifecycleData: PromptElementLifecycleData);
    useState<S = undefined>(): [S | undefined, Dispatch<StateUpdater<S | undefined>>];
    useState<S>(initialState: S | (() => S)): [S, Dispatch<StateUpdater<S>>];
    useData<T>(typePredicate: TypePredicate<T>, consumer: DataConsumer<T>): void;
    isRemountRequired(): boolean;
}
export {};
//# sourceMappingURL=reconciler.d.ts.map